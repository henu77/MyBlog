<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.malong.blog.dao.BlogsMapper">
    <resultMap id="blogMap" type="blog">
        <id column="id" property="id"/>
        <result column="title" property="title"/>
        <result column="views" property="views"/>
        <result column="create_time" property="creatTime"/>
        <result column="update_time" property="updateTime"/>
        <association property="typeId" column="type_id" select="getType"/>
        <association property="userId" column="user_id"  select="getUserInfoById"/>
    </resultMap>

    <resultMap id="typeMap" type="type">
        <id column="id" property="id"/>
        <result column="name" property="name"/>
    </resultMap>

    <resultMap id="userInfoMap" type="userInfo">
        <id column="id" property="id"/>
        <result column="username" property="username"/>
    </resultMap>

    <select id="getBlogsByLimit" resultMap="blogMap">
      select id,title,views,type_id,user_id,create_time,update_time from t_blog order by id limit #{startIndex},#{pageSize};
    </select>

    <select id="getBlogsByLimitByTitle" resultMap="blogMap">
        select id,title,views,type_id,user_id,create_time,update_time from t_blog where title like %#{title}% order by id limit #{startIndex},#{pageSize};
    </select>

    <select id="getBlogsByLimitByUser" resultMap="blogMap">
        select id,title,views,type_id,user_id,create_time,update_time from t_blog where user = #{username} order by id limit #{startIndex},#{pageSize};
    </select>

    <select id="getBlogsByLimitByTitleAndUser" resultMap="blogMap">
        select id,title,views,type_id,user_id,create_time,update_time from t_blog where title like %#{title}% and user = #{username} order by id limit #{startIndex},#{pageSize};
    </select>

    <select id="getUserInfoById" resultType="userInfo">
        select * from t_user where id = #{id};
    </select>

    <select id="getType" resultType="type">
        select * from t_type where id = #{typeId};
    </select>
</mapper>